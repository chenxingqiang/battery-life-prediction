function prediction = predict_lstm(capacity, health_factors)
    % 实现 LSTM prediction
    X = health_factors';
    y = capacity';
    
    numFeatures = size(X, 1);
    numResponses = 1;
    numHiddenUnits = 100;
    
    layers = [ ...
        sequenceInputLayer(numFeatures)
        lstmLayer(numHiddenUnits)
        fullyConnectedLayer(numResponses)
        regressionLayer];
    
    options = trainingOptions('adam', ...
        'MaxEpochs', 100, ...
        'GradientThreshold', 1, ...
        'InitialLearnRate', 0.005, ...
        'LearnRateSchedule', 'piecewise', ...
        'LearnRateDropPeriod', 125, ...
        'LearnRateDropFactor', 0.2, ...
        'Verbose', 0, ...
        'Plots', 'training-progress');
    
    net = trainNetwork(X, y, layers, options);
    prediction = predict(net, X)';
end